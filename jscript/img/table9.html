<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Tabel_opgave</title>
		<meta name="author" content="ato" />
		<link rel="stylesheet" href="tabel_style.css" type="text/css" />
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<!-- Date: 2012-09-17 -->
	
<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">Anders Tornøe</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:Order msdt:dt="string">13000.0000000000</mso:Order>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:PublishingStartDate msdt:dt="string"></mso:PublishingStartDate>
<mso:PublishingExpirationDate msdt:dt="string"></mso:PublishingExpirationDate>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">Anders Tornøe</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:ContentTypeId msdt:dt="string">0x01010029EC440B576D464D9B193B8DEEA663C2</mso:ContentTypeId>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
	<body>
		<div id="window">
			<table border="0" valign = "center" bordercolor="#DDDDDD" style="background-color:#eeeeee" width="864px" cellpadding="2" cellspacing="2">
				<tr>
					<th class="header">Barnets beskæftigelse:</th>
					<th class="header">Ufaglært Arbejder</th>
					<th class="header">Faglært Arbejder</th>
					<th class="header">Selvstændig i Landbrug</th>
					<th class="header">Selvstændig &lt;20 ansatte</th>
					<th class="header">Selvstændig &gt;20 ansatte</th>
					<th class="header">Underordnet funktionær</th>
					<th class="header">Funktionær i mellemgruppen</th>
					<th class="header">Overordnet funtionær</th>
					<th>I alt</th>
				</tr>
				<tr>
					<th class="header_down">Fars stilling:</th>
					<th></th>
					<th></th>
					<th></th>
					<th></th>
					<th></th>
					<th></th>
					<th></th>
					<th></th>
					<th></th>
				</tr>
				<tr>
					<th class="header_down">Ufaglært Arbejder</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Faglært Arbejder</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Selvstændig i Landbrug</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Selvstændig &lt;20 ansatte</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Selvstændig &gt;20 ansatte</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Underordnet funktionær</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Funktionær i mellemgruppen</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
				<tr>
					<th class="header_down">Overordnet funktionær</th>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<td>Table Cell</td>
					<th>100</th>
				</tr>
			</table>
		</div>
		<div id = overlay_container>
			<canvas id="canvas" width="714" height="100">
				Your browser does not support the canvas element.
			</canvas>
			<p class ="feedpct">
				Klik på et felt i tabellen og se hvordan den sociale arv viser sig i forhold til forældrenes arbejde.
			</p>
		</div>
		<script type="text/javascript">
			window.onload = function() {
				alert ("hej");
				var c = document.getElementById('canvas');
				var cxt = c.getContext('2d');

				var img_filled = new Image();
				img_filled.src = 'img/ludo_filled.png';

				var k_img_filled = new Image();
				k_img_filled.src = 'img/k_ludo_filled.png';

				var img_empty = new Image();
				img_empty.src = 'img/ludo_empty.png';

				var k_img_empty = new Image();
				k_img_empty.src = 'img/k_ludo_empty.png';

				var trimmed_txt = "";
				var trimmed_txt2 = "";

				var y_counter = -1;
				var x_counter = 0;
				var ludoheight = 12;
				var ludowidth = 49;

				var pct = 0;
				
				var td_dec = "";
				

				var i = 0;
				drawBlanks();

				//drawLudos(i, 25);


				function drawBlanks() {

					for(var i = 0; i < 100; i++) {

						if((i % 5) == 0) {
							x_counter++;
						}
						if((i % 50) == 0) {
							y_counter++;
							x_counter = 0;
						}
						if((i % 2) == 0) {
							cxt.drawImage(img_empty, x_counter * 12, y_counter * ludowidth);
						} else {
							cxt.drawImage(k_img_empty, x_counter * 12, y_counter * ludowidth);
						}
						x_counter++;
					}
				}

				function drawLudos(i, pct) {

					if(i < 100) {

						if((i % 5) == 0) {
							x_counter++;
						}
						if((i % 50) == 0) {
							y_counter++;
							x_counter = 0;
						}

						if(i < pct) {

							if((i % 2) == 0) {
								cxt.drawImage(img_filled, x_counter * 12, y_counter * ludowidth);
							} else {
								cxt.drawImage(k_img_filled, x_counter * 12, y_counter * ludowidth);
							}

							$(".feedpct").html("Ud af alle børnene af gruppen <b>" + trimmed_txt + "</b>, fik <b><br/><span STYLE='font-size: large; color: #00ADEE'>" + td_dec + "%</span> <br/></b> af børnene arbejde som <b>" + trimmed_txt2 + "</b>. <br/><span STYLE='font-size: small; color: #E23E26'>(ca." + (100 - (i + 1)) + "% af dem blev noget andet..)</span>");

							//$(".feedpct").html((i + 1) + "%"); // af børnene fra gruppen <b>" + trimmed_txt + "</b>"); //, fik <b>" + pct + "% </b> af dem arbejde som <b>" + trimmed_txt2 + "</b>. \n (" + (100 - pct) + "% af dem blev noget andet..");
							//"Hvis vi ser på børnene af gruppen <b>" + trimmed_txt + "</b>, fik <b>" + pct + "% </b> af dem arbejde som <b>" + trimmed_txt2 + "</b>. \n (" + (100 - pct) + "% af dem blev noget andet..)"
							$(".feedpct").css('margin-top', y_counter);

							setTimeout(function() {
								x_counter++;
								i++;
								drawLudos(i, pct);
							}, 30);
						} else {

							$("td").on("click", td_onClick);
						}
					}

				}

				var tal_Array = new Array(38.1, 13.3, 2.3, 3.0, 1.9, 25.5, 8.6, 7.4, 22.9, 12.4, 1.5, 6.4, 3.4, 30.7, 9.0, 13.9, 31.6, 8.2, 19.4, 4.6, 2.3, 16.0, 6.5, 11.4, 20.3, 10.3, 1.9, 6.1, 5.5, 24.2, 7.7, 23.9, 2.0, 2.0, 2.0, 0.6, 14.3, 14.3, 14.3, 51.0, 13.1, 13.1, 1.6, 0.8, 2.5, 32.8, 14.8, 21.3, 18.7, 9.4, 3.7, 4.7, 2.8, 18.7, 15.0, 27.1, 8.6, 7.3, 1.3, 4.6, 3.3, 22.5, 11.3, 41.1);
				var forklaringer_Array = new Array("Ufaglært arbejder: Ingen faglig uddannelse udover folkeskolen", "Faglært arbejder: har en kort, praktisk orienteret uddannelse (f. eks. tømrer, mekaniker, frisør)", "Selvstændig i landbrug: Landmand (som ejer sin egen gård)", "Selvstændig med under 20 ansatte: Driver sit eget firma med mellem 0 og 19 ansatte", "Selvstændig med over 20 ansatte: Driver sit eget firma med over 20 ansatte", "Underordnet funktionær: Arbejder på kontor (og er underordnet andre)", "Funktionær i mellemgruppen: Arbejder på kontor (og har mere ansvar og indflydelse end de underordnede funktionærer)", "Overordnet funktionær: Arbejder på kontor (og har større ansvar og mere indflydelse end både underordnede funktionærer og funktionærer i mellemgruppen)");

				$("td").each(function() {
					var row = $(this).parent("tr").index() - 2;
					var col = $(this).index() - 1;
					var tal = row * 8 + col;
					$(this).css('backgroundColor', '#DDDDDD');
					var dec_tal = tal_Array[tal].toString();
					var dec = dec_tal.replace(".", ",");
					//alert(dec);
					//var id = $(this).attr("id");
					$(this).text(dec);
					// compare id to what you want
				});

				$("td").on("click", td_onClick);
				
				function td_onClick() {

					$('#canvas').animate({
						opacity : 0.3,
						//left: '+=50',
						//height: 'toggle'
					}, 0, function() {
						$('#canvas').animate({
							opacity : 1,
							//left: '+=50',
							//height: 'toggle'
						}, 250, function() {
							// Animation complete.
						});
					});
					$("td").each(function() {
						$(this).css('backgroundColor', '#DDDDDD');
					});

					$(this).css('backgroundColor', '#fff');
					var row = $(this).parent("tr").index() - 2;
					var col = $(this).index() - 1;
					//alert("række" + row + ", kolonne" + col);
					//$("#feed").text("række" + row + ", kolonne" + col);
					var tal = row * 8 + col;

					var num = tal_Array[tal];
					var td_dec_tal = tal_Array[tal].toString();
					td_dec = td_dec_tal.replace(".", ",");
					pct = num;
					var rounded_num = Math.round(num);
					console.log(num);
					y_counter = -1;
					x_counter = 0;

					cxt.clearRect(0, 0, canvas.width, canvas.height);
					$("td").off();
					cxt.beginPath();
					drawBlanks();
					y_counter = -1;
					x_counter = 0;
					drawLudos(0, rounded_num);
					trimmed_txt = forklaringer_Array[row].toLowerCase().split(':')[0];
					trimmed_txt2 = forklaringer_Array[col].toLowerCase().split(':')[0];

					//$(".feedpct").html("Hvis vi ser på børnene af gruppen <b>" + trimmed_txt + "</b>, fik <b>" + pct + "% </b> af dem arbejde som <b>" + trimmed_txt2 + "</b>. \n (" + (100 - pct) + "% af dem blev noget andet..)");
				}


				$(".header").click(function() {
					console.log($(this));
					var pos = $(this).index() - 1;
					$(".feedpct").text(forklaringer_Array[pos]);
				});
				$(".header_down").click(function() {
					console.log($(this));
					var pos = $(this.parentNode).index() - 2;
					/*http://stackoverflow.com/questions/9946687/return-index-of-nested-element*/
					$(".feedpct").text(forklaringer_Array[pos]);
				});
				/*$(".header_down").click(function() {

				 var col = $(this).index() - 1;
				 //alert(col);
				 $("#feed").text(forklaringer_Array[col]);
				 });*/
			};

		</script>
	</body>
</html>
